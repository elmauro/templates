- La generación de plantillas implica el envío de parámetros para hacer las cosultas necesarias
- Las plantillas tienen filtros (un filtro es un campo de una tabla de la base de datos)

- debe haber una relación entre los parámetros y los filtros para hacer las cosultas de información

- Se obtiene el código html de la plantilla (encabezado, contenido, pie de página)
- Se obtinenen todas las columnas de todas las tablas relacionadas con una plantilla y su valor

- La información de una tabla se puede dibujar de forma tabular o no:

	-- tabular: quiere decir que la tabla será dibujada en forma tabular
		
		- se recuperan todas las columnas de la tabla y se crea una etiqueta de la forma {{TAB.[tabla].columna}} por 
		  cada columna de la tabla. Además se hace una consulta dinámica que obtiene toda la información de la tabla.


	-- No tabular: la información de una tabla puede ser detalle de otra tabla o no:

		- detalle: se recuperan todas las columnas de la tabla y se crea una etiqueta de la forma {{DET.[tabla].columna}}  
		           por cada columna de la tabla. Además se hace una consulta dinámica que obtiene toda la información de la tabla.

		- No detalle: se recuperan todas las columnas de la tabla y se crea una etiqueta de la forma 
		              {{[tabla].columna}} por cada columna de la tabla. Además se hace una consulta dinámica que obtiene toda la información de la tabla.

- Se remplaza el código html de la plantilla mapeado con la lista de etiquetas generadas y sus respectivos valores según 
  sea tabular, detalle o no detalle.



Para todas las vistas:

1. si la vista es tabular:
	a. se guarda la tabla en una variable
	b. se obtienen todos los datos de esa tabla
		
		Consecutivo		Tabla 	Columna 		Valor 						Etiqueta
  		1				User	first_name		Mauricio					{{TAB.[User].firs_name}}
  		1				User	last_name		Cadavid						{{TAB.[User].last_name}}
  		1				User	email			elmauro@gmail.com 			{{TAB.[User].email_name}}
  		1				User	phone			3116344194 					{{TAB.[User].phone_name}}

  	c. se crea una etiqueta por cada dato obtenido de la forma {{TAB.[tabla].columna}}
  	d. se guarda la etiqueta en una propiedad llamada etiqueta
	e. se guardan todos los datos obtenidos con sus etiquetas en una propiedad de la variable llamada tabular
	f. se almacena la variable en una lista de objetos


2. de lo contrario:
	a. se obtienen todas las tablas detalle de la tabla
	b. se obtienen todos los datos la tabla 
		Consecutivo		Tabla 	Columna 		Valor 						Etiqueta
  		1				User	first_name		Mauricio					{{[User].firs_name}}
  		1				User	last_name		Cadavid						{{[User].last_name}}
  		1				User	email			elmauro@gmail.com 			{{[User].email}}
  		1				User	phone			3116344194 					{{[User].phone}}

	c. se crea una etiqueta por cada dato obtenido de la forma {{[tabla].columna}}
	d. se crea un filtro por la primera columna de cada dato obtenido; servirá para filtrar la información de las tablas 
	   detalle
	e. por cada tabla detalle se obtienen todos los datos la tabla detalle usando el filtro anterior
	f. se crea una etiqueta por cada dato obtenido de la forma {{DET.[tabla].columna}}
	g. se guarda la etiqueta en una propiedad llamada etiqueta
	h. se guardan todos los datos obtenidos con sus etiquetas en una propiedad de la variable llamada detalle
	i. se almacena la variable en una lista de objetos


Remplazar las etiquetas con sus valores en el código html

Por cada objeto de la lista de objetos:

1. si existe una etiqueta en el objeto remplace en el código html la etiqueta por el valor

2. si el objeto tiene detalles, por cada objeto detalle si existe una etiqueta, almacene la etiqueta y el valor en un 
   diccionario. Luego recorra el diccionario y remplace en el código html cada una de las etiqueta por el valor de la etiqueta.

3. si el objeto tiene tabular, por cada objeto tabular si existe una etiqueta, almacene la etiqueta y el valor en un 
   diccionario. Luego recorra el diccionario y remplace en el código html cada una de las etiqueta por el valor de la etiqueta.

4. añada al código html un nuevo template (html) para continuar con el siguiente objeto de la lista de objetos


Rails with rack support
unicorn application server
nginx static content and slow clients (mem cache support)
git
grit (git from ruby)
smoke (comunicate http servers with git servers)
chimney
proxymachine
ssh
jobs (resque)
solr
postgreSQL
memcached
ajax
nagios
sinatra
ci joe (integration test)


http://mrrio.github.io/jsPDF/examples/basic.html


tables = personal_templates_commons.getTables()

allrows = personal_templates_commons.getAllRows(tables)

template = "<p>Medellin, 21 de Enero de 2015</p><p>Para: users_first_name users_last_name</p><p>De: Administraci&oacute;n</p><p>Asunto: Incremento en la cuota</p><p>Con la entrada en vigor del a&ntilde;o 2015, se incrementar&aacute; la couta menusal de administraci&oacute;n en $10.000 con el fin de regularizar la misma al incremento de precios al consumo que se hace efectiva a partir del 1 de enero de 2015</p><p>&nbsp;</p><p>&nbsp;</p><p>Manuel Garc&iacute;a</p><p>Administrador&nbsp;&nbsp;</p>"

combined = personal_templates_commons.combineAllRows(allrows, template)

personal_templates_commons.createPDF(combined)